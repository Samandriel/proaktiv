generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Trackers {
  id             String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  title          String
  trackerType    String[]
  trackerGroupId String?        @db.Uuid
  dataLog        Json[]         @db.Json
  description    String?
  userId         String         @db.Uuid
  createdAt      DateTime       @default(now())
  updatedAt      DateTime       @default(now()) @updatedAt
  TrackerGroup   TrackerGroups? @relation(fields: [trackerGroupId], references: [id])
  user           Users          @relation(fields: [userId], references: [id])
}

model TrackerGroups {
  id        String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name      String
  userId    String     @db.Uuid
  createdAt DateTime   @default(now())
  updatedAt DateTime   @default(now()) @updatedAt
  Tracker   Trackers[]
  user      Users      @relation(fields: [userId], references: [id])
}

model Todos {
  id          String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  title       String
  description String?
  completed   Boolean    @default(false)
  priority    Int        @default(0)
  eventId     String?    @unique @db.Uuid
  userId      String     @db.Uuid
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @default(now()) @updatedAt
  event       Events?    @relation(fields: [eventId], references: [id])
  user        Users      @relation(fields: [userId], references: [id])
  TodoTag     TodoTags[]
}

model Notes {
  id         String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  title      String
  body       String?
  pinned     Boolean    @default(false)
  background String?
  archived   Boolean    @default(false)
  userId     String     @db.Uuid
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @default(now()) @updatedAt
  user       Users      @relation(fields: [userId], references: [id])
  NoteTag    NoteTags[]
}

model Events {
  id           String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  recurrence   Boolean  @default(false)
  start        DateTime
  end          DateTime
  interval     Int?
  intervalUnit String?
  reminder     Int?
  reminderUnit String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @default(now()) @updatedAt
  Todo         Todos?
}

model Tags {
  id        String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name      String
  createdAt DateTime   @default(now())
  updatedAt DateTime   @default(now()) @updatedAt
  NoteTag   NoteTags[]
  TodoTag   TodoTags[]
}

model TodoTags {
  id        String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  todoId    String   @db.Uuid
  tagId     String   @db.Uuid
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt
  Tag       Tags     @relation(fields: [tagId], references: [id])
  Todo      Todos    @relation(fields: [todoId], references: [id])
}

model NoteTags {
  id        String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  noteId    String   @db.Uuid
  tagId     String   @db.Uuid
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt
  Note      Notes    @relation(fields: [noteId], references: [id])
  Tag       Tags     @relation(fields: [tagId], references: [id])
}

model Users {
  id                String               @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  email             String               @unique
  password          String
  createdAt         DateTime             @default(now())
  updatedAt         DateTime             @default(now()) @updatedAt
  Note              Notes[]
  Todo              Todos[]
  Tracker           Trackers[]
  TrackerGroup      TrackerGroups[]
  OAuth             UserOAuths[]
  UserPasswordReset UserPasswordResets[]
  UserPreference    UserPreferences[]
  UserProfile       UserProfiles[]
  UserSession       UserSessions[]
}

model UserOAuths {
  id             String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  userId         String   @db.Uuid
  accessToken    String   @unique
  refreshToken   String   @unique
  provider       String
  providerUserId String
  createdAt      DateTime @default(now())
  updatedAt      DateTime @default(now()) @updatedAt
  User           Users    @relation(fields: [userId], references: [id])
}

model UserProfiles {
  id        String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  firstName String
  lastName  String
  bio       String?
  avatar    String?
  userId    String   @db.Uuid
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt
  User      Users    @relation(fields: [userId], references: [id])
}

model UserSessions {
  id        String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  token     String   @unique
  userId    String   @db.Uuid
  ipAddress String
  platform  String
  browser   String
  userAgent String
  expiresAt DateTime
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt
  User      Users    @relation(fields: [userId], references: [id])
}

model UserPasswordResets {
  id        String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  token     String   @unique @default(dbgenerated("gen_random_uuid()"))
  userId    String   @db.Uuid
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt
  User      Users    @relation(fields: [userId], references: [id])
}

model UserPreferences {
  id                 String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  userId             String   @db.Uuid
  theme              String   @default("light")
  notesView          String   @default("list")
  notesSort          String   @default("updated")
  notesSortDirection String   @default("desc")
  notesCustomSort    String[] @default([])
  createdAt          DateTime @default(now())
  updatedAt          DateTime @default(now()) @updatedAt
  User               Users    @relation(fields: [userId], references: [id])
}
